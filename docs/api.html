<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/8.8.4/mermaid.min.js"></script>
<script src="/init.js"></script><title data-react-helmet="true">API Reference | Dataform GA4 Sessions</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://ArtemKorneevGA.github.io/dataform-ga4-sessions/api"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="API Reference | Dataform GA4 Sessions"><meta data-react-helmet="true" name="description" content="dataform-ga4-sessions"><meta data-react-helmet="true" property="og:description" content="dataform-ga4-sessions"><link data-react-helmet="true" rel="shortcut icon" href="/dataform-ga4-sessions/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://ArtemKorneevGA.github.io/dataform-ga4-sessions/api"><link data-react-helmet="true" rel="alternate" href="https://ArtemKorneevGA.github.io/dataform-ga4-sessions/api" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://ArtemKorneevGA.github.io/dataform-ga4-sessions/api" hreflang="x-default"><link rel="stylesheet" href="/dataform-ga4-sessions/assets/css/styles.04041f29.css">
<link rel="preload" href="/dataform-ga4-sessions/assets/js/runtime~main.a6d437cf.js" as="script">
<link rel="preload" href="/dataform-ga4-sessions/assets/js/main.db21b18a.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/dataform-ga4-sessions/"><img src="/dataform-ga4-sessions/img/logo.png" alt="Dataform GA4 Sessions" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/dataform-ga4-sessions/img/logo.png" alt="Dataform GA4 Sessions" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><b class="navbar__title">Dataform GA4 Sessions</b></a><a class="navbar__item navbar__link navbar__link--active" href="/dataform-ga4-sessions/">Docs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/dataform-ga4-sessions/api">API Reference</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/ArtemKorneevGA/dataform-ga4-sessions" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_2i4l react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_iYfV">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_iYfV">🌞</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button class="clean-btn backToTopButton_i9tI" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh menuWithAnnouncementBar_+O1J"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/dataform-ga4-sessions/">Introduction</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Guides</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Sessions</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Events</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/dataform-ga4-sessions/api">API Reference</a></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>API Reference</h1></header><a name="module_dataform-ga4-sessions"></a><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="dataform-ga4-sessions"></a>dataform-ga4-sessions<a class="hash-link" href="#dataform-ga4-sessions" title="Direct link to heading">#</a></h2><p>dataform-ga4-sessions module</p><p><strong>Example</strong>  </p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> ga4 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;dataform-ga4-sessions&#x27;</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ul><li><a href="#module_dataform-ga4-sessions">dataform-ga4-sessions</a><ul><li><a href="#module_dataform-ga4-sessions..DataformAction">~DataformAction</a><ul><li><a href="#new_module_dataform-ga4-sessions..DataformAction_new">new DataformAction(sourceConfig, targetConfig)</a></li><li><a href="#module_dataform-ga4-sessions..DataformAction+_source">._source</a></li><li><a href="#module_dataform-ga4-sessions..DataformAction+_target">._target</a></li><li><a href="#module_dataform-ga4-sessions..DataformAction+_timezone">._timezone</a></li><li><a href="#module_dataform-ga4-sessions..DataformAction+_tags">._tags</a></li><li><a href="#module_dataform-ga4-sessions..DataformAction+_assertions">._assertions</a></li><li><a href="#module_dataform-ga4-sessions..DataformAction+_partitionBy">._partitionBy</a></li><li><a href="#module_dataform-ga4-sessions..DataformAction+_uniqueKey">._uniqueKey</a></li><li><a href="#module_dataform-ga4-sessions..DataformAction+_clusterBy">._clusterBy</a></li><li><a href="#module_dataform-ga4-sessions..DataformAction+_updatePartitionFilter">._updatePartitionFilter</a></li><li><a href="#module_dataform-ga4-sessions..DataformAction+_additionalOptions">._additionalOptions</a></li><li><a href="#module_dataform-ga4-sessions..DataformAction+_partitionExpirationDays">._partitionExpirationDays</a></li><li><a href="#module_dataform-ga4-sessions..DataformAction+_requirePartitionFilter">._requirePartitionFilter</a></li><li><a href="#module_dataform-ga4-sessions..DataformAction+_columns">._columns</a></li><li><a href="#module_dataform-ga4-sessions..DataformAction+_eventParams">._eventParams</a></li><li><a href="#module_dataform-ga4-sessions..DataformAction+_userProperties">._userProperties</a></li><li><a href="#module_dataform-ga4-sessions..DataformAction+_queryParameters">._queryParameters</a></li><li><a href="#module_dataform-ga4-sessions..DataformAction+_itemColumns">._itemColumns</a></li><li><a href="#module_dataform-ga4-sessions..DataformAction+_itemParams">._itemParams</a></li><li><a href="#module_dataform-ga4-sessions..DataformAction+addColumns">.addColumns(columns)</a></li><li><a href="#module_dataform-ga4-sessions..DataformAction+addEventParams">.addEventParams(eventParams)</a></li><li><a href="#module_dataform-ga4-sessions..DataformAction+addUserProperties">.addUserProperties(userProperties)</a></li><li><a href="#module_dataform-ga4-sessions..DataformAction+addQueryParameters">.addQueryParameters(queryParameters)</a></li><li><a href="#module_dataform-ga4-sessions..DataformAction+addItemColumns">.addItemColumns()</a></li><li><a href="#module_dataform-ga4-sessions..DataformAction+addItemParams">.addItemParams()</a></li><li><a href="#module_dataform-ga4-sessions..DataformAction+getSqlUniqueId">.getSqlUniqueId()</a></li><li><a href="#module_dataform-ga4-sessions..DataformAction+publish">.publish()</a></li><li><a href="#module_dataform-ga4-sessions..DataformAction+publishAssertions">.publishAssertions()</a></li></ul></li><li><a href="#module_dataform-ga4-sessions..Event">~Event</a> ⇐ <code>DataformAction</code><ul><li><a href="#new_module_dataform-ga4-sessions..Event_new">new Event(sourceConfig, targetConfig)</a></li><li><a href="#module_dataform-ga4-sessions..Event+_uniqueKey">._uniqueKey</a></li><li><a href="#module_dataform-ga4-sessions..Event+_timestampEventParamName">._timestampEventParamName</a></li><li><a href="#module_dataform-ga4-sessions..Event+addItemColumns">.addItemColumns()</a></li><li><a href="#module_dataform-ga4-sessions..Event+addItemParams">.addItemParams()</a></li><li><a href="#module_dataform-ga4-sessions..Event+skipUniqueEventsStep">.skipUniqueEventsStep()</a></li><li><a href="#module_dataform-ga4-sessions..Event+getSqlUniqueId">.getSqlUniqueId()</a></li><li><a href="#module_dataform-ga4-sessions..Event+setEventName">.setEventName(eventName)</a></li><li><a href="#module_dataform-ga4-sessions..Event+publish">.publish()</a></li></ul></li><li><a href="#module_dataform-ga4-sessions..EventFactory">~EventFactory</a><ul><li><a href="#new_module_dataform-ga4-sessions..EventFactory_new">new EventFactory(sourceConfig)</a></li><li><a href="#module_dataform-ga4-sessions..EventFactory+_timestampEventParamName">._timestampEventParamName</a></li><li><a href="#module_dataform-ga4-sessions..EventFactory+_targetSchema">._targetSchema</a></li><li><a href="#module_dataform-ga4-sessions..EventFactory+createEvent">.createEvent(eventConfig)</a> ⇒ <code>Event</code></li><li><a href="#module_dataform-ga4-sessions..EventFactory+createEvents">.createEvents(eventConfig)</a> ⇒ <code>Array.&lt;Event&gt;</code></li><li><a href="#module_dataform-ga4-sessions..EventFactory+createEcommerceEvents">.createEcommerceEvents()</a> ⇒ <code>Array.&lt;Event&gt;</code></li><li><a href="#module_dataform-ga4-sessions..EventFactory+createFormEvents">.createFormEvents()</a> ⇒ <code>Array.&lt;Event&gt;</code></li><li><a href="#module_dataform-ga4-sessions..EventFactory+createAllRecommendedEvents">.createAllRecommendedEvents()</a> ⇒ <code>Array.&lt;Event&gt;</code></li></ul></li><li><a href="#module_dataform-ga4-sessions..Session">~Session</a> ⇐ <code>DataformAction</code><ul><li><a href="#new_module_dataform-ga4-sessions..Session_new">new Session(sourceConfig, targetConfig)</a></li><li><a href="#module_dataform-ga4-sessions..Session+_uniqueKey">._uniqueKey</a></li><li><a href="#module_dataform-ga4-sessions..Session+_sourceMediumRules">._sourceMediumRules</a></li><li><a href="#module_dataform-ga4-sessions..Session+_postProcessing">._postProcessing</a></li><li><a href="#module_dataform-ga4-sessions..Session+_processingSteps">._processingSteps</a></li><li><a href="#module_dataform-ga4-sessions..Session+_lastNonDirectLookBackWindow">._lastNonDirectLookBackWindow</a></li><li><a href="#module_dataform-ga4-sessions..Session+_assertions">._assertions</a></li><li><a href="#module_dataform-ga4-sessions..Session+applyPreset">.applyPreset(presetName)</a></li><li><a href="#module_dataform-ga4-sessions..Session+getSqlUniqueId">.getSqlUniqueId()</a></li><li><a href="#module_dataform-ga4-sessions..Session+skipLastNonDirectStep">.skipLastNonDirectStep()</a></li><li><a href="#module_dataform-ga4-sessions..Session+skipChannelStep">.skipChannelStep()</a></li><li><a href="#module_dataform-ga4-sessions..Session+skipSourceMediumStep">.skipSourceMediumStep()</a></li><li><a href="#module_dataform-ga4-sessions..Session+publish">.publish()</a></li><li><a href="#module_dataform-ga4-sessions..Session+publishAssertions">.publishAssertions()</a></li></ul></li></ul></li></ul><a name="module_dataform-ga4-sessions..DataformAction"></a><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="dataform-ga4-sessionsdataformaction"></a>dataform-ga4-sessions~DataformAction<a class="hash-link" href="#dataform-ga4-sessionsdataformaction" title="Direct link to heading">#</a></h3><p>Creates Dataform Action to build GA4 Event tables based on BigQuery exported data.</p><p><strong>Kind</strong>: inner class of <a href="#module_dataform-ga4-sessions"><code>dataform-ga4-sessions</code></a><br>
<strong>Access</strong>: package  </p><ul><li><a href="#module_dataform-ga4-sessions..DataformAction">~DataformAction</a><ul><li><a href="#new_module_dataform-ga4-sessions..DataformAction_new">new DataformAction(sourceConfig, targetConfig)</a></li><li><a href="#module_dataform-ga4-sessions..DataformAction+_source">._source</a></li><li><a href="#module_dataform-ga4-sessions..DataformAction+_target">._target</a></li><li><a href="#module_dataform-ga4-sessions..DataformAction+_timezone">._timezone</a></li><li><a href="#module_dataform-ga4-sessions..DataformAction+_tags">._tags</a></li><li><a href="#module_dataform-ga4-sessions..DataformAction+_assertions">._assertions</a></li><li><a href="#module_dataform-ga4-sessions..DataformAction+_partitionBy">._partitionBy</a></li><li><a href="#module_dataform-ga4-sessions..DataformAction+_uniqueKey">._uniqueKey</a></li><li><a href="#module_dataform-ga4-sessions..DataformAction+_clusterBy">._clusterBy</a></li><li><a href="#module_dataform-ga4-sessions..DataformAction+_updatePartitionFilter">._updatePartitionFilter</a></li><li><a href="#module_dataform-ga4-sessions..DataformAction+_additionalOptions">._additionalOptions</a></li><li><a href="#module_dataform-ga4-sessions..DataformAction+_partitionExpirationDays">._partitionExpirationDays</a></li><li><a href="#module_dataform-ga4-sessions..DataformAction+_requirePartitionFilter">._requirePartitionFilter</a></li><li><a href="#module_dataform-ga4-sessions..DataformAction+_columns">._columns</a></li><li><a href="#module_dataform-ga4-sessions..DataformAction+_eventParams">._eventParams</a></li><li><a href="#module_dataform-ga4-sessions..DataformAction+_userProperties">._userProperties</a></li><li><a href="#module_dataform-ga4-sessions..DataformAction+_queryParameters">._queryParameters</a></li><li><a href="#module_dataform-ga4-sessions..DataformAction+_itemColumns">._itemColumns</a></li><li><a href="#module_dataform-ga4-sessions..DataformAction+_itemParams">._itemParams</a></li><li><a href="#module_dataform-ga4-sessions..DataformAction+addColumns">.addColumns(columns)</a></li><li><a href="#module_dataform-ga4-sessions..DataformAction+addEventParams">.addEventParams(eventParams)</a></li><li><a href="#module_dataform-ga4-sessions..DataformAction+addUserProperties">.addUserProperties(userProperties)</a></li><li><a href="#module_dataform-ga4-sessions..DataformAction+addQueryParameters">.addQueryParameters(queryParameters)</a></li><li><a href="#module_dataform-ga4-sessions..DataformAction+addItemColumns">.addItemColumns()</a></li><li><a href="#module_dataform-ga4-sessions..DataformAction+addItemParams">.addItemParams()</a></li><li><a href="#module_dataform-ga4-sessions..DataformAction+getSqlUniqueId">.getSqlUniqueId()</a></li><li><a href="#module_dataform-ga4-sessions..DataformAction+publish">.publish()</a></li><li><a href="#module_dataform-ga4-sessions..DataformAction+publishAssertions">.publishAssertions()</a></li></ul></li></ul><a name="new_module_dataform-ga4-sessions..DataformAction_new"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="new-dataformactionsourceconfig-targetconfig"></a>new DataformAction(sourceConfig, targetConfig)<a class="hash-link" href="#new-dataformactionsourceconfig-targetconfig" title="Direct link to heading">#</a></h4><table><thead><tr><th>Param</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>sourceConfig</td><td><code>Object</code></td><td>GA4 BigQuery Source configuration</td></tr><tr><td>sourceConfig.database</td><td><code>string</code></td><td>The GA4 export database name. For example <code>&lt;YOUR-GCP-PROJECT-ID&gt;</code></td></tr><tr><td>sourceConfig.dataset</td><td><code>string</code></td><td>The GA4 export database name. For example <code>&lt;YOUR-GCP-PROJECT-ID&gt;</code></td></tr><tr><td>sourceConfig.incrementalTableName</td><td><code>string</code></td><td>Source incremental table name. For example <code>events_20240101</code></td></tr><tr><td>sourceConfig.nonIncrementalTableName</td><td><code>string</code></td><td>Source non-incremental table name. For example <code>events_*</code></td></tr><tr><td>sourceConfig.incrementalTableEventStepWhere</td><td><code>string</code></td><td>This property set where condition for the incremental queries. The important note this condition is added to the first step, not the final step. So if you filter for example events with source / medium values you could miss this data in the final result. Default is false</td></tr><tr><td>sourceConfig.nonIncrementalTableEventStepWhere</td><td><code>string</code></td><td>This property set where condition for the non-incremental queries. The important note this condition is added to the first step, not the final step. So if you filter for example events with source / medium values you could miss this data in the final result. Default is false</td></tr><tr><td>targetConfig</td><td><code>Object</code></td><td>Optional. Target configuration</td></tr><tr><td>targetConfig.schema</td><td><code>string</code></td><td>Optional. Target schema name</td></tr><tr><td>targetConfig.tableName</td><td><code>string</code></td><td>Optional. Target table name</td></tr></tbody></table><a name="module_dataform-ga4-sessions..DataformAction+_source"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="dataformaction_source"></a>dataformAction._source<a class="hash-link" href="#dataformaction_source" title="Direct link to heading">#</a></h4><p><strong>Kind</strong>: instance property of <a href="#module_dataform-ga4-sessions..DataformAction"><code>DataformAction</code></a><br>
<strong>Properties</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>source</td><td><code>Object</code></td><td>GA4 BigQuery Source configuration</td></tr><tr><td>source.database</td><td><code>string</code></td><td>The GA4 export database name. For example <code>&lt;YOUR-GCP-PROJECT-ID&gt;</code></td></tr><tr><td>source.dataset</td><td><code>string</code></td><td>The GA4 export database name. For example <code>&lt;YOUR-GCP-PROJECT-ID&gt;</code></td></tr><tr><td>source.incrementalTableName</td><td><code>string</code></td><td>Source incremental table name. For example <code>events_20240101</code></td></tr><tr><td>source.nonIncrementalTableName</td><td><code>string</code></td><td>Source non-incremental table name. For example <code>events_*</code></td></tr><tr><td>source.incrementalTableEventStepWhere</td><td><code>string</code></td><td>This property set where condition for the incremental queries. The important note this condition is added to the first step, not the final step. So if you filter for example events with source / medium values you could miss this data in the final result. Default is false</td></tr><tr><td>source.nonIncrementalTableEventStepWhere</td><td><code>string</code></td><td>This property set where condition for the non-incremental queries. The important note this condition is added to the first step, not the final step. So if you filter for example events with source / medium values you could miss this data in the final result. Default is false</td></tr></tbody></table><a name="module_dataform-ga4-sessions..DataformAction+_target"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="dataformaction_target"></a>dataformAction._target<a class="hash-link" href="#dataformaction_target" title="Direct link to heading">#</a></h4><p>Use getter / setter methods to set values for the following properties.</p><p><strong>Kind</strong>: instance property of <a href="#module_dataform-ga4-sessions..DataformAction"><code>DataformAction</code></a><br>
<strong>Properties</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>target</td><td><code>Object</code></td><td>Destination table config.</td></tr><tr><td>target.schema</td><td><code>string</code></td><td>The target schema. Destination dataset name. Default is dataform_staging</td></tr><tr><td>target.tableName</td><td><code>string</code></td><td>The target table name. Destination table name.</td></tr></tbody></table><p><strong>Example</strong>  </p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">session</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">target</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token literal-property property" style="color:#36acaa">schema</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;dataform_testing&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">tableName</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;test_sessions&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><a name="module_dataform-ga4-sessions..DataformAction+_timezone"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="dataformaction_timezone"></a>dataformAction._timezone<a class="hash-link" href="#dataformaction_timezone" title="Direct link to heading">#</a></h4><p><strong>Kind</strong>: instance property of <a href="#module_dataform-ga4-sessions..DataformAction"><code>DataformAction</code></a><br>
<strong>Properties</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>timezone</td><td><code>string</code></td><td>The timezone. Default is <code>Europe/London</code></td></tr></tbody></table><p><strong>Example</strong>  </p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">session</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">timezone</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Europe/Berlin&quot;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><a name="module_dataform-ga4-sessions..DataformAction+_tags"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="dataformaction_tags"></a>dataformAction._tags<a class="hash-link" href="#dataformaction_tags" title="Direct link to heading">#</a></h4><p><strong>Kind</strong>: instance property of <a href="#module_dataform-ga4-sessions..DataformAction"><code>DataformAction</code></a><br>
<strong>Properties</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>tags</td><td><code>Array.&lt;string&gt;</code></td><td>Dataform <a href="https://cloud.google.com/dataform/docs/tags" target="_blank" rel="noopener noreferrer">execution tags</a> needed to run a chose a set of actions to run. By default <code>[source.dataset]</code> tag is added.</td></tr></tbody></table><p><strong>Example</strong>  </p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">session</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">tags</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;daily&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;hourly&quot;</span><span class="token punctuation" style="color:#393A34">]</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><a name="module_dataform-ga4-sessions..DataformAction+_assertions"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="dataformaction_assertions"></a>dataformAction._assertions<a class="hash-link" href="#dataformaction_assertions" title="Direct link to heading">#</a></h4><p><strong>Kind</strong>: instance property of <a href="#module_dataform-ga4-sessions..DataformAction"><code>DataformAction</code></a><br>
<strong>Properties</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>assertions</td><td><code>Array.&lt;{name: String, config: {description: String}, query: function(String): String}&gt;</code></td><td>List of default <a href="https://cloud.google.com/dataform/docs/assertions" target="_blank" rel="noopener noreferrer">Dataform assertions</a> for the class, but in most cases if you need extra assertions you could define them outside the class in separate files.</td></tr></tbody></table><a name="module_dataform-ga4-sessions..DataformAction+_partitionBy"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="dataformaction_partitionby"></a>dataformAction._partitionBy<a class="hash-link" href="#dataformaction_partitionby" title="Direct link to heading">#</a></h4><p><strong>Kind</strong>: instance property of <a href="#module_dataform-ga4-sessions..DataformAction"><code>DataformAction</code></a><br>
<strong>Properties</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>partitionBy</td><td><code>string</code></td><td>The [partition by])(<a href="https://cloud.google.com/dataform/docs/partitions-clusters#create_a_table_partition" target="_blank" rel="noopener noreferrer">https://cloud.google.com/dataform/docs/partitions-clusters#create_a_table_partition</a>). Dataform use this keys to generate partitioned tables. By default partitionBy is set to <code>date</code>. If you want to use another partitionBy value you need to set it manually.</td></tr></tbody></table><p><strong>Example</strong>  </p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">session</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">_partitionBy</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;DATE(timestamp)&quot;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><a name="module_dataform-ga4-sessions..DataformAction+_uniqueKey"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="dataformaction_uniquekey"></a>dataformAction._uniqueKey<a class="hash-link" href="#dataformaction_uniquekey" title="Direct link to heading">#</a></h4><p><strong>Kind</strong>: instance property of <a href="#module_dataform-ga4-sessions..DataformAction"><code>DataformAction</code></a><br>
<strong>Properties</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>uniqueKey</td><td><code>string</code></td><td>The <a href="https://cloud.google.com/dataform/docs/incremental-tables#merge_rows_in_an_incremental_table" target="_blank" rel="noopener noreferrer">unique key</a> for incremental tables. Dataform use this keys to generate merge queries.</td></tr></tbody></table><p><strong>Example</strong>  </p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">session</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">uniqueKey</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;session_id&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;date&quot;</span><span class="token punctuation" style="color:#393A34">]</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><a name="module_dataform-ga4-sessions..DataformAction+_clusterBy"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="dataformaction_clusterby"></a>dataformAction._clusterBy<a class="hash-link" href="#dataformaction_clusterby" title="Direct link to heading">#</a></h4><p><strong>Kind</strong>: instance property of <a href="#module_dataform-ga4-sessions..DataformAction"><code>DataformAction</code></a><br>
<strong>Properties</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>clusterBy</td><td><code>Array.&lt;string&gt;</code></td><td>The <a href="https://cloud.google.com/dataform/docs/partitions-clusters#create_a_table_cluster" target="_blank" rel="noopener noreferrer">cluster by</a>. Dataform use this keys to generate clustered tables. By default clusterBy is not set. If you want to use clusterBy you need to set it manually.</td></tr></tbody></table><p><strong>Example</strong>  </p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">session</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">clusterBy</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;name&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;revenue&quot;</span><span class="token punctuation" style="color:#393A34">]</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><a name="module_dataform-ga4-sessions..DataformAction+_updatePartitionFilter"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="dataformaction_updatepartitionfilter"></a>dataformAction._updatePartitionFilter<a class="hash-link" href="#dataformaction_updatepartitionfilter" title="Direct link to heading">#</a></h4><p><strong>Kind</strong>: instance property of <a href="#module_dataform-ga4-sessions..DataformAction"><code>DataformAction</code></a><br>
<strong>Properties</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>updatePartitionFilter</td><td><code>string</code></td><td>The <a href="https://cloud.google.com/dataform/docs/incremental-tables#filter_rows_in_an_incremental_table" target="_blank" rel="noopener noreferrer">update partition filter</a>. Dataform use this keys to to avoid scanning the whole table to find matching rows, set updatePartitionFilter to only consider a subset of records. By default updatePartitionFilter is not set. If you want to use updatePartitionFilter you need to set it manually.</td></tr></tbody></table><p><strong>Example</strong>  </p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">session</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">updatePartitionFilter</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;timestamp &gt;= timestamp_sub(current_timestamp(), interval 24 hour)&quot;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><a name="module_dataform-ga4-sessions..DataformAction+_additionalOptions"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="dataformaction_additionaloptions"></a>dataformAction._additionalOptions<a class="hash-link" href="#dataformaction_additionaloptions" title="Direct link to heading">#</a></h4><p><strong>Kind</strong>: instance property of <a href="#module_dataform-ga4-sessions..DataformAction"><code>DataformAction</code></a><br>
<strong>Properties</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>additionalOptions</td><td><code>Object</code></td><td><a href="https://cloud.google.com/dataform/docs/reference/dataform-core-reference#bigquery" target="_blank" rel="noopener noreferrer">IBigQueryOptions additionalOptions</a>. Key-value pairs for the table, view, and materialized view options.</td></tr></tbody></table><p><strong>Example</strong>  </p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">session</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">additionalOptions</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token literal-property property" style="color:#36acaa">numeric_option</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;5&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">string_option</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&quot;string-value&quot;&#x27;</span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><a name="module_dataform-ga4-sessions..DataformAction+_partitionExpirationDays"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="dataformaction_partitionexpirationdays"></a>dataformAction._partitionExpirationDays<a class="hash-link" href="#dataformaction_partitionexpirationdays" title="Direct link to heading">#</a></h4><p><strong>Kind</strong>: instance property of <a href="#module_dataform-ga4-sessions..DataformAction"><code>DataformAction</code></a><br>
<strong>Properties</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>partitionExpirationDays</td><td><code>number</code></td><td><a href="https://cloud.google.com/dataform/docs/reference/dataform-core-reference#bigquery" target="_blank" rel="noopener noreferrer">IBigQueryOptions partitionExpirationDays</a>. The number of days for which BigQuery stores data in each partition. The setting applies to all partitions in a table, but is calculated independently for each partition based on the partition time.</td></tr></tbody></table><p><strong>Example</strong>  </p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">session</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">partitionExpirationDays</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">90</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><a name="module_dataform-ga4-sessions..DataformAction+_requirePartitionFilter"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="dataformaction_requirepartitionfilter"></a>dataformAction._requirePartitionFilter<a class="hash-link" href="#dataformaction_requirepartitionfilter" title="Direct link to heading">#</a></h4><p><strong>Kind</strong>: instance property of <a href="#module_dataform-ga4-sessions..DataformAction"><code>DataformAction</code></a><br>
<strong>Properties</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>requirePartitionFilter</td><td><code>boolean</code></td><td><a href="https://cloud.google.com/dataform/docs/reference/dataform-core-reference#bigquery" target="_blank" rel="noopener noreferrer">IBigQueryOptions partitionExpirationDays</a>. Declares whether the partitioned table requires a WHERE clause predicate filter that filters the partitioning column.</td></tr></tbody></table><p><strong>Example</strong>  </p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">session</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">requirePartitionFilter</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><a name="module_dataform-ga4-sessions..DataformAction+_columns"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="dataformaction_columns"></a>dataformAction._columns<a class="hash-link" href="#dataformaction_columns" title="Direct link to heading">#</a></h4><p><strong>Kind</strong>: instance property of <a href="#module_dataform-ga4-sessions..DataformAction"><code>DataformAction</code></a><br>
<strong>Properties</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>columns</td><td><code>Array.&lt;Object&gt;</code></td><td>List of columns from GA4 raw table to be added to the final table. You could check the list of all available columns <a href="https://support.google.com/analytics/answer/7029846?hl=en" target="_blank" rel="noopener noreferrer">here</a>. By default columns are added based on the preset. Or you could add them manually using <code>addColumns</code> method.</td></tr><tr><td>columns[].name</td><td><code>String</code></td><td>Name of the column in GA4 raw table.</td></tr><tr><td>[columns[].columnName]</td><td><code>String</code></td><td>Optional. The name of the column in the result table. If not provided the name will be the same as in GA4 raw table.</td></tr></tbody></table><a name="module_dataform-ga4-sessions..DataformAction+_eventParams"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="dataformaction_eventparams"></a>dataformAction._eventParams<a class="hash-link" href="#dataformaction_eventparams" title="Direct link to heading">#</a></h4><p><strong>Kind</strong>: instance property of <a href="#module_dataform-ga4-sessions..DataformAction"><code>DataformAction</code></a><br>
<strong>Properties</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>eventParams</td><td><code>Array.&lt;Object&gt;</code></td><td>List of event params unnested from GA4 raw table event_params column. By default <code>eventParams</code> are added based on the preset. You could add your custom event_params using <code>addEventParams</code> method.</td></tr><tr><td>eventParams[].name</td><td><code>String</code></td><td>The value of <code>key</code> in the event_params record.</td></tr><tr><td>[eventParams[].columnName]</td><td><code>String</code></td><td>Optional. The name of the column in the result table. If not provided the name will be the same as <code>eventParams[].name</code>.</td></tr><tr><td>[eventParams[].type]</td><td><code>&#x27;string&#x27;</code> | <code>&#x27;int&#x27;</code> | <code>&#x27;double&#x27;</code> | <code>&#x27;float&#x27;</code> | <code>&#x27;coalesce&#x27;</code> | <code>&#x27;coalesce_float&#x27;</code></td><td>Optional. The name of the value in the event_params column. By default <code>string</code>.</td></tr></tbody></table><a name="module_dataform-ga4-sessions..DataformAction+_userProperties"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="dataformaction_userproperties"></a>dataformAction._userProperties<a class="hash-link" href="#dataformaction_userproperties" title="Direct link to heading">#</a></h4><p><strong>Kind</strong>: instance property of <a href="#module_dataform-ga4-sessions..DataformAction"><code>DataformAction</code></a><br>
<strong>Properties</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>userProperties</td><td><code>Array.&lt;Object&gt;</code></td><td>List of user properties unnested from GA4 raw table user_properties column. By default <code>userProperties</code> are not added. You could add your custom user_properties using <code>addUserProperties</code> method.</td></tr><tr><td>userProperties[].name</td><td><code>String</code></td><td>The value of <code>key</code> in the user_properties record.</td></tr><tr><td>[userProperties[].columnName]</td><td><code>String</code></td><td>Optional. The name of the column in the result table. If not provided the name will be the same as <code>userProperties[].name</code>.</td></tr><tr><td>[userProperties[].type]</td><td><code>&#x27;string&#x27;</code> | <code>&#x27;int&#x27;</code> | <code>&#x27;double&#x27;</code> | <code>&#x27;float&#x27;</code> | <code>&#x27;coalesce&#x27;</code> | <code>&#x27;coalesce_float&#x27;</code></td><td>Optional. The name of the value in the event_params column. By default <code>string</code>.</td></tr></tbody></table><a name="module_dataform-ga4-sessions..DataformAction+_queryParameters"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="dataformaction_queryparameters"></a>dataformAction._queryParameters<a class="hash-link" href="#dataformaction_queryparameters" title="Direct link to heading">#</a></h4><p><strong>Kind</strong>: instance property of <a href="#module_dataform-ga4-sessions..DataformAction"><code>DataformAction</code></a><br>
<strong>Properties</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>queryParameters</td><td><code>Array.&lt;Object&gt;</code></td><td>List of query parameters from the unnested <code>event_params</code> column with the key <code>page_location</code>. You could add your custom query_parameters using <code>addQueryParameters</code> method.</td></tr><tr><td>queryParameters[].name</td><td><code>String</code></td><td>The query parameter name.</td></tr><tr><td>[queryParameters[].columnName]</td><td><code>String</code></td><td>Optional. The name of the column in the result table. If not provided the name will be the same as <code>queryParameters[].name</code>.</td></tr></tbody></table><a name="module_dataform-ga4-sessions..DataformAction+_itemColumns"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="dataformaction_itemcolumns"></a>dataformAction._itemColumns<a class="hash-link" href="#dataformaction_itemcolumns" title="Direct link to heading">#</a></h4><p><strong>Kind</strong>: instance property of <a href="#module_dataform-ga4-sessions..DataformAction"><code>DataformAction</code></a><br>
<strong>Properties</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>itemColumns</td><td><code>Array.&lt;Object&gt;</code></td><td>List of child columns to keep in the final table from <code>items</code> column. By default <code>itemColumns</code> are not added, and if items added as a column all child columns wil be added. You could add itemColumns manually using <code>addItemColumns</code> method.</td></tr><tr><td>itemColumns[].name</td><td><code>String</code></td><td>Name of child column the column in GA4 raw table.</td></tr><tr><td>[itemColumns[].columnName]</td><td><code>String</code></td><td>Optional. The name of the column in the result table. If not provided the name will be the same as <code>itemColumns[].name</code>.</td></tr></tbody></table><a name="module_dataform-ga4-sessions..DataformAction+_itemParams"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="dataformaction_itemparams"></a>dataformAction._itemParams<a class="hash-link" href="#dataformaction_itemparams" title="Direct link to heading">#</a></h4><p><strong>Kind</strong>: instance property of <a href="#module_dataform-ga4-sessions..DataformAction"><code>DataformAction</code></a><br>
<strong>Properties</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>itemParams</td><td><code>Array.&lt;Object&gt;</code></td><td>List of event params of item scope  unnested from GA4 raw table items.item_params column. By default <code>itemParams</code> are not added. You could add your custom item_params using <code>addItemParams</code> method.</td></tr><tr><td>itemParams[].name</td><td><code>String</code></td><td>The value of <code>key</code> in the items.item_params record.</td></tr><tr><td>[itemParams[].columnName]</td><td><code>String</code></td><td>Optional. The name of the column in the result table. If not provided the name will be the same as <code>itemParams[].name</code>.</td></tr><tr><td>[userProperties[].type]</td><td><code>&#x27;string&#x27;</code> | <code>&#x27;int&#x27;</code> | <code>&#x27;double&#x27;</code> | <code>&#x27;float&#x27;</code> | <code>&#x27;coalesce&#x27;</code> | <code>&#x27;coalesce_float&#x27;</code></td><td>Optional. The name of the value in the event_params column. By default <code>string</code>.</td></tr></tbody></table><a name="module_dataform-ga4-sessions..DataformAction+addColumns"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="dataformactionaddcolumnscolumns"></a>dataformAction.addColumns(columns)<a class="hash-link" href="#dataformactionaddcolumnscolumns" title="Direct link to heading">#</a></h4><div class="admonition admonition-warning alert alert--danger"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>warning</h5></div><div class="admonition-content"><p>If you add columns with <code>RECORD</code> type, like: <code>device.*</code>, <code>geo.*</code> you should specify the <code>columnName</code>. Because the result column name couldn&#x27;t have a dot (.) symbol in the name.</p></div></div><p><strong>Kind</strong>: instance method of <a href="#module_dataform-ga4-sessions..DataformAction"><code>DataformAction</code></a>  </p><table><thead><tr><th>Param</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>columns</td><td><code>Array.&lt;Object&gt;</code></td><td>List of columns from GA4 raw table to be added to the final table.</td></tr><tr><td>columns[].name</td><td><code>String</code></td><td>Name of the column in GA4 raw table.</td></tr><tr><td>[columns[].columnName]</td><td><code>String</code></td><td>Optional. The name of the column in the result table. If not provided the name will be the same as in GA4 raw table.</td></tr></tbody></table><p><strong>Example</strong>  </p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">session</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">addColumns</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;geo.city&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">columnName</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;city&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;geo.metro&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">columnName</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;metro&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;stream_id&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;platform&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><a name="module_dataform-ga4-sessions..DataformAction+addEventParams"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="dataformactionaddeventparamseventparams"></a>dataformAction.addEventParams(eventParams)<a class="hash-link" href="#dataformactionaddeventparamseventparams" title="Direct link to heading">#</a></h4><p><strong>Kind</strong>: instance method of <a href="#module_dataform-ga4-sessions..DataformAction"><code>DataformAction</code></a>  </p><table><thead><tr><th>Param</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>eventParams</td><td><code>Array.&lt;Object&gt;</code></td><td>List of event params unnested from GA4 raw table event_params column.</td></tr><tr><td>eventParams[].name</td><td><code>String</code></td><td>The value of <code>key</code> in the event_params record.</td></tr><tr><td>[eventParams[].columnName]</td><td><code>String</code></td><td>Optional. The name of the column in the result table. If not provided the name will be the same as <code>eventParams[].name</code>.</td></tr><tr><td>[eventParams[].type]</td><td><code>&#x27;string&#x27;</code> | <code>&#x27;int&#x27;</code> | <code>&#x27;double&#x27;</code> | <code>&#x27;float&#x27;</code> | <code>&#x27;coalesce&#x27;</code> | <code>&#x27;coalesce_float&#x27;</code></td><td>Optional. The name of the value in the event_params column. By default <code>string</code>.</td></tr></tbody></table><p><strong>Example</strong>  </p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">session</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">addEventParams</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;page_title&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">type</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><a name="module_dataform-ga4-sessions..DataformAction+addUserProperties"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="dataformactionadduserpropertiesuserproperties"></a>dataformAction.addUserProperties(userProperties)<a class="hash-link" href="#dataformactionadduserpropertiesuserproperties" title="Direct link to heading">#</a></h4><p><strong>Kind</strong>: instance method of <a href="#module_dataform-ga4-sessions..DataformAction"><code>DataformAction</code></a>  </p><table><thead><tr><th>Param</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>userProperties</td><td><code>Array.&lt;Object&gt;</code></td><td>List of user properties unnested from GA4 raw table user_properties column.</td></tr><tr><td>userProperties[].name</td><td><code>String</code></td><td>The value of <code>key</code> in the user_properties record.</td></tr><tr><td>[userProperties[].columnName]</td><td><code>String</code></td><td>Optional. The name of the column in the result table. If not provided the name will be the same as <code>userProperties[].name</code>.</td></tr><tr><td>[userProperties[].type]</td><td><code>&#x27;string&#x27;</code> | <code>&#x27;int&#x27;</code> | <code>&#x27;double&#x27;</code> | <code>&#x27;float&#x27;</code> | <code>&#x27;coalesce&#x27;</code> | <code>&#x27;coalesce_float&#x27;</code></td><td>Optional. The name of the value in the event_params column. By default <code>string</code>.</td></tr></tbody></table><p><strong>Example</strong>  </p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">session</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">addUserProperties</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;user_status&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">type</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><a name="module_dataform-ga4-sessions..DataformAction+addQueryParameters"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="dataformactionaddqueryparametersqueryparameters"></a>dataformAction.addQueryParameters(queryParameters)<a class="hash-link" href="#dataformactionaddqueryparametersqueryparameters" title="Direct link to heading">#</a></h4><p><strong>Kind</strong>: instance method of <a href="#module_dataform-ga4-sessions..DataformAction"><code>DataformAction</code></a>  </p><table><thead><tr><th>Param</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>queryParameters</td><td><code>Array.&lt;Object&gt;</code></td><td>List of query parameters from the unnested <code>event_params</code> column with the key <code>page_location</code>.</td></tr><tr><td>queryParameters[].name</td><td><code>String</code></td><td>The query parameter name.</td></tr><tr><td>[queryParameters[].columnName]</td><td><code>String</code></td><td>Optional. The name of the column in the result table. If not provided the name will be the same as <code>queryParameters[].name</code>.</td></tr></tbody></table><p><strong>Example</strong>  </p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">session</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">addQueryParameters</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;fbclid&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ttclid&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;gclid&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">columnName</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;gclid_url&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><a name="module_dataform-ga4-sessions..DataformAction+addItemColumns"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="dataformactionadditemcolumns"></a>dataformAction.addItemColumns()<a class="hash-link" href="#dataformactionadditemcolumns" title="Direct link to heading">#</a></h4><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Supported only in Event class</p></div></div><p>In the example below from items columns only <code>item_id</code>, <code>item_name</code>, <code>price</code>, <code>quantity</code> will be added to the final table in the <code>items.item_id</code>, <code>items.item_name</code>, <code>items.price</code>, <code>items.quantity</code> accordingly.</p><p><strong>Kind</strong>: instance method of <a href="#module_dataform-ga4-sessions..DataformAction"><code>DataformAction</code></a><br>
<strong>Properties</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>itemColumns</td><td><code>Array.&lt;Object&gt;</code></td><td>List of child columns to keep in the final table from <code>items</code> column. By default <code>itemColumns</code> are not added, and if items added as a column all child columns wil be added. You could add itemColumns manually using <code>addItemColumns</code> method.</td></tr><tr><td>itemColumns[].name</td><td><code>String</code></td><td>Name of child column the column in GA4 raw table.</td></tr><tr><td>[itemColumns[].columnName]</td><td><code>String</code></td><td>Optional. The name of the column in the result table. If not provided the name will be the same as <code>itemColumns[].name</code>.</td></tr></tbody></table><p><strong>Example</strong>  </p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">purchase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">addItemColumns</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;item_id&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;item_name&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;price&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;quantity&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><a name="module_dataform-ga4-sessions..DataformAction+addItemParams"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="dataformactionadditemparams"></a>dataformAction.addItemParams()<a class="hash-link" href="#dataformactionadditemparams" title="Direct link to heading">#</a></h4><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Supported only in Event class</p></div></div><p>In the example below the items.item_params column will be expanded and filtered for the key color. The resulting string values will be stored in items.item_color.</p><p><strong>Kind</strong>: instance method of <a href="#module_dataform-ga4-sessions..DataformAction"><code>DataformAction</code></a>  </p><table><thead><tr><th>Param</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>[userProperties[].type]</td><td><code>&#x27;string&#x27;</code> | <code>&#x27;int&#x27;</code> | <code>&#x27;double&#x27;</code> | <code>&#x27;float&#x27;</code> | <code>&#x27;coalesce&#x27;</code> | <code>&#x27;coalesce_float&#x27;</code></td><td>Optional. The type of the value in the <code>items.item_params</code> column. By default <code>string</code>.</td></tr></tbody></table><p><strong>Properties</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>itemParams</td><td><code>Array.&lt;Object&gt;</code></td><td>List of names of item-scoped custom dimensions to extract  from <code>items.item_params</code> by key.  By default <code>itemParams</code> are not added. You could add itemParams manually using <code>addItemParams</code> method.</td></tr><tr><td>itemParams[].name</td><td><code>String</code></td><td>Name of item-scoped custom dimensions.</td></tr><tr><td>[itemParams[].columnName]</td><td><code>String</code></td><td>Optional. The name of the column in the result table. If not provided the name will be the same as <code>itemParams[].name</code>.</td></tr></tbody></table><p><strong>Example</strong>  </p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">purchase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">addItemParams</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;color&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">columnName</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;item_color&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><a name="module_dataform-ga4-sessions..DataformAction+getSqlUniqueId"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="dataformactiongetsqluniqueid"></a>dataformAction.getSqlUniqueId()<a class="hash-link" href="#dataformactiongetsqluniqueid" title="Direct link to heading">#</a></h4><p>Helper method to generate SQL code to get unique id for each row in a final table, used inside publish method. Should be overwritten in the child class.</p><p><strong>Kind</strong>: instance method of <a href="#module_dataform-ga4-sessions..DataformAction"><code>DataformAction</code></a>  </p><a name="module_dataform-ga4-sessions..DataformAction+publish"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="dataformactionpublish"></a>dataformAction.publish()<a class="hash-link" href="#dataformactionpublish" title="Direct link to heading">#</a></h4><p>Main method to publish Dataform Action. This method generates SQL and then uses Dataform core <a href="https://cloud.google.com/dataform/docs/reference/dataform-core-reference#publish" target="_blank" rel="noopener noreferrer">publish</a> method to generate incremental and non-incremental session table. This method should be overwritten in the child class.</p><p><strong>Kind</strong>: instance method of <a href="#module_dataform-ga4-sessions..DataformAction"><code>DataformAction</code></a>  </p><a name="module_dataform-ga4-sessions..DataformAction+publishAssertions"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="dataformactionpublishassertions"></a>dataformAction.publishAssertions()<a class="hash-link" href="#dataformactionpublishassertions" title="Direct link to heading">#</a></h4><p>The method to publish default <a href="https://cloud.google.com/dataform/docs/assertions" target="_blank" rel="noopener noreferrer">Dataform assertions</a>. This method should be overwritten in the child class.</p><p><strong>Kind</strong>: instance method of <a href="#module_dataform-ga4-sessions..DataformAction"><code>DataformAction</code></a>  </p><a name="module_dataform-ga4-sessions..Event"></a><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="dataform-ga4-sessionsevent--dataformaction"></a>dataform-ga4-sessions~Event ⇐ <code>DataformAction</code><a class="hash-link" href="#dataform-ga4-sessionsevent--dataformaction" title="Direct link to heading">#</a></h3><p>Creates Dataform Action to build GA4 event tables based on BigQuery exported data, for example table for <code>purchase</code> events. But instead of using this class directly, it is recommended to use <code>EventFactory</code> to create events. The factory could simplify the creation of auto or recommended events. But after the creation of the event, you could use any of <code>DataformAction</code> methods and properties.</p><p><strong>Kind</strong>: inner class of <a href="#module_dataform-ga4-sessions"><code>dataform-ga4-sessions</code></a><br>
<strong>Extends</strong>: <code>DataformAction</code>  </p><ul><li><a href="#module_dataform-ga4-sessions..Event">~Event</a> ⇐ <code>DataformAction</code><ul><li><a href="#new_module_dataform-ga4-sessions..Event_new">new Event(sourceConfig, targetConfig)</a></li><li><a href="#module_dataform-ga4-sessions..Event+_uniqueKey">._uniqueKey</a></li><li><a href="#module_dataform-ga4-sessions..Event+_timestampEventParamName">._timestampEventParamName</a></li><li><a href="#module_dataform-ga4-sessions..Event+addItemColumns">.addItemColumns()</a></li><li><a href="#module_dataform-ga4-sessions..Event+addItemParams">.addItemParams()</a></li><li><a href="#module_dataform-ga4-sessions..Event+skipUniqueEventsStep">.skipUniqueEventsStep()</a></li><li><a href="#module_dataform-ga4-sessions..Event+getSqlUniqueId">.getSqlUniqueId()</a></li><li><a href="#module_dataform-ga4-sessions..Event+setEventName">.setEventName(eventName)</a></li><li><a href="#module_dataform-ga4-sessions..Event+publish">.publish()</a></li></ul></li></ul><a name="new_module_dataform-ga4-sessions..Event_new"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="new-eventsourceconfig-targetconfig"></a>new Event(sourceConfig, targetConfig)<a class="hash-link" href="#new-eventsourceconfig-targetconfig" title="Direct link to heading">#</a></h4><p>Constructor for the Event class inherited from DataformAction class. Before creating the object of this class you need to declare GA4 source tables using <code>declareSources</code> method.</p><table><thead><tr><th>Param</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>sourceConfig</td><td><code>Object</code></td><td>GA4 BigQuery Source configuration</td></tr><tr><td>sourceConfig.database</td><td><code>string</code></td><td>The GA4 export database name. For example <code>&lt;YOUR-GCP-PROJECT-ID&gt;</code></td></tr><tr><td>sourceConfig.dataset</td><td><code>string</code></td><td>The GA4 export database name. For example <code>&lt;YOUR-GCP-PROJECT-ID&gt;</code></td></tr><tr><td>sourceConfig.incrementalTableName</td><td><code>string</code></td><td>Source incremental table name. For example <code>events_20240101</code></td></tr><tr><td>sourceConfig.nonIncrementalTableName</td><td><code>string</code></td><td>Source non-incremental table name. For example <code>events_*</code></td></tr><tr><td>sourceConfig.incrementalTableEventStepWhere</td><td><code>string</code></td><td>This property set where condition for the incremental queries. The important note this condition is added to the first step, not the final step. So if you filter for example events with source / medium values you could miss this data in the final result. Default is false</td></tr><tr><td>sourceConfig.nonIncrementalTableEventStepWhere</td><td><code>string</code></td><td>This property set where condition for the non-incremental queries. The important note this condition is added to the first step, not the final step. So if you filter for example events with source / medium values you could miss this data in the final result. Default is false</td></tr><tr><td>targetConfig</td><td><code>Object</code></td><td>Optional. Target configuration</td></tr><tr><td>targetConfig.schema</td><td><code>string</code></td><td>Optional. Target schema name. Default is <code>dataform_staging</code></td></tr><tr><td>targetConfig.tableName</td><td><code>string</code></td><td>Optional. Target table name.</td></tr></tbody></table><p><strong>Example</strong>  </p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Define your config</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> eventConfig </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token literal-property property" style="color:#36acaa">dataset</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;analytics_XXXXXX&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token literal-property property" style="color:#36acaa">incrementalTableName</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;events_XXXXXX&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Declare GA4 source tables</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">ga4</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">declareSources</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">eventConfig</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Create event</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> purchase </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">ga4</span><span class="token class-name punctuation" style="color:#393A34">.</span><span class="token class-name">Event</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">eventConfig</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Set destination table name and add where conditions for the event</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">purchase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">setEventName</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;purchase&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><a name="module_dataform-ga4-sessions..Event+_uniqueKey"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="event_uniquekey"></a>event._uniqueKey<a class="hash-link" href="#event_uniquekey" title="Direct link to heading">#</a></h4><p><strong>Kind</strong>: instance property of <a href="#module_dataform-ga4-sessions..Event"><code>Event</code></a><br>
<strong>Properties</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>uniqueKey</td><td><code>string</code></td><td>The <a href="https://cloud.google.com/dataform/docs/incremental-tables#merge_rows_in_an_incremental_table" target="_blank" rel="noopener noreferrer">unique key</a> for incremental tables. Dataform use this keys to generate merge queries. Default value for Event is <code>[&quot;date&quot;, &quot;event_id&quot;]</code></td></tr></tbody></table><p><strong>Example</strong>  </p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">event</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">uniqueKey</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;event_id&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;date&quot;</span><span class="token punctuation" style="color:#393A34">]</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><a name="module_dataform-ga4-sessions..Event+_timestampEventParamName"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="event_timestampeventparamname"></a>event._timestampEventParamName<a class="hash-link" href="#event_timestampeventparamname" title="Direct link to heading">#</a></h4><p><strong>Kind</strong>: instance property of <a href="#module_dataform-ga4-sessions..Event"><code>Event</code></a><br>
<strong>Properties</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>timestampEventParamName</td><td><code>string</code></td><td>This property will be used to generate unique event_id. The value will be from unnested <code>event_params</code> column with the key equals the value of this property. But at first you should add this event parameter in your GTM setup. <code>js event.timestampEventParamName = &quot;gtm_event_timestamp&quot; </code></td></tr></tbody></table><a name="module_dataform-ga4-sessions..Event+addItemColumns"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="eventadditemcolumns"></a>event.addItemColumns()<a class="hash-link" href="#eventadditemcolumns" title="Direct link to heading">#</a></h4><div class="admonition admonition-warning alert alert--danger"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>warning</h5></div><div class="admonition-content"><p>If you provide doesn&#x27;t existing column name in the <code>itemColumns</code> list, you will get a SQL error and can&#x27;t build the table.</p></div></div><p>In the example below from items columns only <code>item_id</code>, <code>item_name</code>, <code>price</code>, <code>quantity</code> will be added to the final table in the <code>items.item_id</code>, <code>items.item_name</code>, <code>items.price</code>, <code>items.quantity</code> accordingly.</p><p><strong>Kind</strong>: instance method of <a href="#module_dataform-ga4-sessions..Event"><code>Event</code></a><br>
<strong>Properties</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>itemColumns</td><td><code>Array.&lt;Object&gt;</code></td><td>List of child columns to keep in the final table from <code>items</code> column. By default <code>itemColumns</code> are not added, and if items added as a column all child columns wil be added. You could add itemColumns manually using <code>addItemColumns</code> method.</td></tr><tr><td>itemColumns[].name</td><td><code>String</code></td><td>Name of child column the column in GA4 raw table.</td></tr><tr><td>[itemColumns[].columnName]</td><td><code>String</code></td><td>Optional. The name of the column in the result table. If not provided the name will be the same as <code>itemColumns[].name</code>.</td></tr></tbody></table><p><strong>Example</strong>  </p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">purchase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">addItemColumns</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;item_id&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;item_name&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;price&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;quantity&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><a name="module_dataform-ga4-sessions..Event+addItemParams"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="eventadditemparams"></a>event.addItemParams()<a class="hash-link" href="#eventadditemparams" title="Direct link to heading">#</a></h4><div class="admonition admonition-warning alert alert--danger"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>warning</h5></div><div class="admonition-content"><p>item_params were added to the BigQuery export late October 2023. And you can&#x27;t use addItemParams for events before that date.</p></div></div><p>In the example below the items.item_params column will be expanded and filtered for the key color. The resulting string values will be stored in items.item_color.</p><p><strong>Kind</strong>: instance method of <a href="#module_dataform-ga4-sessions..Event"><code>Event</code></a>  </p><table><thead><tr><th>Param</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>[userProperties[].type]</td><td><code>&#x27;string&#x27;</code> | <code>&#x27;int&#x27;</code> | <code>&#x27;double&#x27;</code> | <code>&#x27;float&#x27;</code> | <code>&#x27;coalesce&#x27;</code> | <code>&#x27;coalesce_float&#x27;</code></td><td>Optional. The type of the value in the <code>items.item_params</code> column. By default <code>string</code>.</td></tr></tbody></table><p><strong>Properties</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>itemParams</td><td><code>Array.&lt;Object&gt;</code></td><td>List of names of item-scoped custom dimensions to extract  from <code>items.item_params</code> by key.  By default <code>itemParams</code> are not added. You could add itemParams manually using <code>addItemParams</code> method.</td></tr><tr><td>itemParams[].name</td><td><code>String</code></td><td>Name of item-scoped custom dimensions.</td></tr><tr><td>[itemParams[].columnName]</td><td><code>String</code></td><td>Optional. The name of the column in the result table. If not provided the name will be the same as <code>itemParams[].name</code>.</td></tr></tbody></table><p><strong>Example</strong>  </p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">purchase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">addItemParams</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;color&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">columnName</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;item_color&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><a name="module_dataform-ga4-sessions..Event+skipUniqueEventsStep"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="eventskipuniqueeventsstep"></a>event.skipUniqueEventsStep()<a class="hash-link" href="#eventskipuniqueeventsstep" title="Direct link to heading">#</a></h4><p>Helper method to skip unique events step. By default <code>where</code> condition is added to filter all events with <code>event_id</code> equals to null. Also <code>QUALIFY</code> statement is added to get only one event per <code>event_id</code>. But if you want to skip this step you could use this method.</p><p><strong>Kind</strong>: instance method of <a href="#module_dataform-ga4-sessions..Event"><code>Event</code></a><br>
<strong>Example</strong>  </p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">event</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">skipUniqueEventsStep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><a name="module_dataform-ga4-sessions..Event+getSqlUniqueId"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="eventgetsqluniqueid"></a>event.getSqlUniqueId()<a class="hash-link" href="#eventgetsqluniqueid" title="Direct link to heading">#</a></h4><p>Helper method to generate SQL code to get unique id for each row in a final table, used inside publish method. By default it use getSqlEventId from dataform-ga4-helpers package</p><p><strong>Kind</strong>: instance method of <a href="#module_dataform-ga4-sessions..Event"><code>Event</code></a>  </p><a name="module_dataform-ga4-sessions..Event+setEventName"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="eventseteventnameeventname"></a>event.setEventName(eventName)<a class="hash-link" href="#eventseteventnameeventname" title="Direct link to heading">#</a></h4><p>This helper method will use event name to define target table and  add where conditions for the final query. It&#x27;s recommended to use <code>EventFactory</code> to create events. But if you want to create event manually you could use this method.</p><p><strong>Kind</strong>: instance method of <a href="#module_dataform-ga4-sessions..Event"><code>Event</code></a>  </p><table><thead><tr><th>Param</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>eventName</td><td><code>string</code></td><td>The event name. For example <code>purchase</code></td></tr></tbody></table><p><strong>Example</strong>  </p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">event</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">setEventName</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;purchase&quot;</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><a name="module_dataform-ga4-sessions..Event+publish"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="eventpublish"></a>event.publish()<a class="hash-link" href="#eventpublish" title="Direct link to heading">#</a></h4><p>Main method to publish Dataform Action. This method generates SQL and then uses Dataform core <a href="https://cloud.google.com/dataform/docs/reference/dataform-core-reference#publish" target="_blank" rel="noopener noreferrer">publish</a> method to generate incremental and non-incremental session table. This method should be overwritten in the child class.</p><p><strong>Kind</strong>: instance method of <a href="#module_dataform-ga4-sessions..Event"><code>Event</code></a><br>
<strong>Example</strong>  </p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">purchase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">publish</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><a name="module_dataform-ga4-sessions..EventFactory"></a><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="dataform-ga4-sessionseventfactory"></a>dataform-ga4-sessions~EventFactory<a class="hash-link" href="#dataform-ga4-sessionseventfactory" title="Direct link to heading">#</a></h3><p>Helper class to create GA4 events. It&#x27;s recommended to use this class to create events. But if you want to create event manually you could use <code>Event</code> class.</p><p><strong>Kind</strong>: inner class of <a href="#module_dataform-ga4-sessions"><code>dataform-ga4-sessions</code></a>  </p><ul><li><a href="#module_dataform-ga4-sessions..EventFactory">~EventFactory</a><ul><li><a href="#new_module_dataform-ga4-sessions..EventFactory_new">new EventFactory(sourceConfig)</a></li><li><a href="#module_dataform-ga4-sessions..EventFactory+_timestampEventParamName">._timestampEventParamName</a></li><li><a href="#module_dataform-ga4-sessions..EventFactory+_targetSchema">._targetSchema</a></li><li><a href="#module_dataform-ga4-sessions..EventFactory+createEvent">.createEvent(eventConfig)</a> ⇒ <code>Event</code></li><li><a href="#module_dataform-ga4-sessions..EventFactory+createEvents">.createEvents(eventConfig)</a> ⇒ <code>Array.&lt;Event&gt;</code></li><li><a href="#module_dataform-ga4-sessions..EventFactory+createEcommerceEvents">.createEcommerceEvents()</a> ⇒ <code>Array.&lt;Event&gt;</code></li><li><a href="#module_dataform-ga4-sessions..EventFactory+createFormEvents">.createFormEvents()</a> ⇒ <code>Array.&lt;Event&gt;</code></li><li><a href="#module_dataform-ga4-sessions..EventFactory+createAllRecommendedEvents">.createAllRecommendedEvents()</a> ⇒ <code>Array.&lt;Event&gt;</code></li></ul></li></ul><a name="new_module_dataform-ga4-sessions..EventFactory_new"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="new-eventfactorysourceconfig"></a>new EventFactory(sourceConfig)<a class="hash-link" href="#new-eventfactorysourceconfig" title="Direct link to heading">#</a></h4><p>Create any recommended or auto event using EventFactory method like <code>createEventName</code>.</p><table><thead><tr><th>Param</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>sourceConfig</td><td><code>Object</code></td><td>GA4 BigQuery Source configuration</td></tr><tr><td>sourceConfig.database</td><td><code>string</code></td><td>The GA4 export database name. For example <code>&lt;YOUR-GCP-PROJECT-ID&gt;</code></td></tr><tr><td>sourceConfig.dataset</td><td><code>string</code></td><td>The GA4 export database name. For example <code>&lt;YOUR-GCP-PROJECT-ID&gt;</code></td></tr><tr><td>sourceConfig.incrementalTableName</td><td><code>string</code></td><td>Source incremental table name. For example <code>events_20240101</code></td></tr><tr><td>sourceConfig.nonIncrementalTableName</td><td><code>string</code></td><td>Source non-incremental table name. For example <code>events_*</code></td></tr><tr><td>sourceConfig.incrementalTableEventStepWhere</td><td><code>string</code></td><td>This property set where condition for the incremental queries. The important note this condition is added to the first step, not the final step. So if you filter for example events with source / medium values you could miss this data in the final result. Default is false</td></tr><tr><td>sourceConfig.nonIncrementalTableEventStepWhere</td><td><code>string</code></td><td>This property set where condition for the non-incremental queries. The important note this condition is added to the first step, not the final step. So if you filter for example events with source / medium values you could miss this data in the final result. Default is false</td></tr></tbody></table><p><strong>Example</strong>  </p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Define your config</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> eventConfig </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token literal-property property" style="color:#36acaa">dataset</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;analytics_XXXXXX&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token literal-property property" style="color:#36acaa">incrementalTableName</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;events_XXXXXX&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Define EventFactory</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> ef </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">ga4</span><span class="token class-name punctuation" style="color:#393A34">.</span><span class="token class-name">EventFactory</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">eventConfig</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Create purchase event:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> purchase </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ef</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">createPurchase</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//Publish event</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">purchase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">publish</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><a name="module_dataform-ga4-sessions..EventFactory+_timestampEventParamName"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="eventfactory_timestampeventparamname"></a>eventFactory._timestampEventParamName<a class="hash-link" href="#eventfactory_timestampeventparamname" title="Direct link to heading">#</a></h4><p><strong>Kind</strong>: instance property of <a href="#module_dataform-ga4-sessions..EventFactory"><code>EventFactory</code></a><br>
<strong>Properties</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>timestampEventParamName</td><td><code>string</code></td><td>This property will be used to generate unique event_id. The value will be from unnested <code>event_params</code> column with the key equals the value of this property. But at first you should add this event parameter in your GTM setup.</td></tr></tbody></table><p><strong>Example</strong>  </p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Define EventFactory</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> ef </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">ga4</span><span class="token class-name punctuation" style="color:#393A34">.</span><span class="token class-name">EventFactory</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">eventConfig</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Set timestampEventParamName</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">ef</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">timestampEventParamName</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;gtm_event_timestamp&quot;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><a name="module_dataform-ga4-sessions..EventFactory+_targetSchema"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="eventfactory_targetschema"></a>eventFactory._targetSchema<a class="hash-link" href="#eventfactory_targetschema" title="Direct link to heading">#</a></h4><p><strong>Kind</strong>: instance property of <a href="#module_dataform-ga4-sessions..EventFactory"><code>EventFactory</code></a><br>
<strong>Properties</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>targetSchema</td><td><code>string</code></td><td>This property will be used to set target schema for all events generated by factory.</td></tr></tbody></table><p><strong>Example</strong>  </p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Define EventFactory</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> ef </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">ga4</span><span class="token class-name punctuation" style="color:#393A34">.</span><span class="token class-name">EventFactory</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">eventConfig</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Set target schema for all events created by factory</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">ef</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">targetSchema</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;my_schema&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> events </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ef</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">createEcommerceEvents</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">events</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">forEach</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">event</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// But you could overwrite target schema for particular event</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">event</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">target</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">tableName</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;purchase&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        event</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">target</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">schema</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot; my_schema_2&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    event</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">publish</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><a name="module_dataform-ga4-sessions..EventFactory+createEvent"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="eventfactorycreateeventeventconfig--event"></a>eventFactory.createEvent(eventConfig) ⇒ <code>Event</code><a class="hash-link" href="#eventfactorycreateeventeventconfig--event" title="Direct link to heading">#</a></h4><p><strong>Kind</strong>: instance method of <a href="#module_dataform-ga4-sessions..EventFactory"><code>EventFactory</code></a><br>
<strong>Returns</strong>: <code>Event</code> - Event object  </p><table><thead><tr><th>Param</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>eventConfig</td><td><code>Object</code></td><td>Event configuration</td></tr><tr><td>eventConfig.eventName</td><td><code>String</code></td><td>Event name. For example <code>purchase</code></td></tr><tr><td>[eventConfig.columns]</td><td><code>Object</code></td><td>List of columns from GA4 raw table to be added to the final table. You could check the list of all available columns <a href="https://support.google.com/analytics/answer/7029846?hl=en" target="_blank" rel="noopener noreferrer">here</a>. By default columns are added based on the preset. Or you could add them manually using <code>addColumns</code> method.</td></tr><tr><td>[eventConfig.columns.name]</td><td><code>String</code></td><td>Name of the column in GA4 raw table.</td></tr><tr><td>[eventConfig.columns.columnName]</td><td><code>String</code></td><td>Optional. The name of the column in the result table. If not provided the name will be the same as in GA4 raw table.</td></tr><tr><td>[eventConfig.eventParams]</td><td><code>Object</code></td><td>List of event params unnested from GA4 raw table event_params column. By default <code>eventParams</code> are added based on the preset. You could add your custom event_params using <code>addEventParams</code> method.</td></tr><tr><td>[eventConfig.eventParams.name]</td><td><code>String</code></td><td>The value of <code>key</code> in the event_params record.</td></tr><tr><td>[eventParams.columnName]</td><td><code>String</code></td><td>Optional. The name of the column in the result table. If not provided the name will be the same as <code>eventParams.name</code>.</td></tr><tr><td>[eventConfig.eventParams.type]</td><td><code>&#x27;string&#x27;</code> | <code>&#x27;int&#x27;</code> | <code>&#x27;double&#x27;</code> | <code>&#x27;float&#x27;</code> | <code>&#x27;coalesce&#x27;</code> | <code>&#x27;coalesce_float&#x27;</code></td><td>Optional. The name of the value in the event_params column. By default <code>string</code>.</td></tr><tr><td>[eventConfig.userProperties]</td><td><code>Object</code></td><td>List of user properties unnested from GA4 raw table user_properties column. By default <code>userProperties</code> are not added. You could add your custom user_properties using <code>addUserProperties</code> method.</td></tr><tr><td>[eventConfig.userProperties.name]</td><td><code>String</code></td><td>The value of <code>key</code> in the user_properties record.</td></tr><tr><td>[eventConfig.userProperties.columnName]</td><td><code>String</code></td><td>Optional. The name of the column in the result table. If not provided the name will be the same as <code>userProperties.name</code>.</td></tr><tr><td>[eventConfig.userProperties.type]</td><td><code>&#x27;string&#x27;</code> | <code>&#x27;int&#x27;</code> | <code>&#x27;double&#x27;</code> | <code>&#x27;float&#x27;</code> | <code>&#x27;coalesce&#x27;</code> | <code>&#x27;coalesce_float&#x27;</code></td><td>Optional. The name of the value in the event_params column. By default <code>string</code>.</td></tr><tr><td>[eventConfig.queryParameters]</td><td><code>Object</code></td><td>List of query parameters from the unnested <code>event_params</code> column with the key <code>page_location</code>. You could add your custom query_parameters using <code>addQueryParameters</code> method.</td></tr><tr><td>[eventConfig.queryParameters.name]</td><td><code>String</code></td><td>The query parameter name.</td></tr><tr><td>[eventConfig.queryParameters.columnName]</td><td><code>String</code></td><td>Optional. The name of the column in the result table. If not provided the name will be the same as <code>queryParameters[].name</code>.</td></tr></tbody></table><p><strong>Example</strong>  </p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> purchase </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ef</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">createEvent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">eventName</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;session_start&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">columns</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token literal-property property" style="color:#36acaa">name</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;privacy_info.analytics_storage&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">columnName</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;analytics_storage&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">eventParams</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;page_referrer&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">type</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><a name="module_dataform-ga4-sessions..EventFactory+createEvents"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="eventfactorycreateeventseventconfig--arrayevent"></a>eventFactory.createEvents(eventConfig) ⇒ <code>Array.&lt;Event&gt;</code><a class="hash-link" href="#eventfactorycreateeventseventconfig--arrayevent" title="Direct link to heading">#</a></h4><p>Tne method to create multiple events using list of events configurations. This method is useful if you want to reuse the same event configurations between projects. In this case you could define event configurations in separate file and import the configs and create events using this helper method.</p><p><strong>Kind</strong>: instance method of <a href="#module_dataform-ga4-sessions..EventFactory"><code>EventFactory</code></a><br>
<strong>Returns</strong>: <code>Array.&lt;Event&gt;</code> - List of events  </p><table><thead><tr><th>Param</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>eventConfig</td><td><code>Array.&lt;Object&gt;</code></td><td>List of event configurations</td></tr><tr><td>eventConfig[].eventName</td><td><code>String</code></td><td>Event name. For example <code>purchase</code></td></tr><tr><td>[eventConfig[].columns]</td><td><code>Object</code></td><td>List of columns from GA4 raw table to be added to the final table. You could check the list of all available columns <a href="https://support.google.com/analytics/answer/7029846?hl=en" target="_blank" rel="noopener noreferrer">here</a>. By default columns are added based on the preset. Or you could add them manually using <code>addColumns</code> method.</td></tr><tr><td>[eventConfig[].columns.name]</td><td><code>String</code></td><td>Name of the column in GA4 raw table.</td></tr><tr><td>[eventConfig[].columns.columnName]</td><td><code>String</code></td><td>Optional. The name of the column in the result table. If not provided the name will be the same as in GA4 raw table.</td></tr><tr><td>[eventConfig[].eventParams]</td><td><code>Object</code></td><td>List of event params unnested from GA4 raw table event_params column. By default <code>eventParams</code> are added based on the preset. You could add your custom event_params using <code>addEventParams</code> method.</td></tr><tr><td>[eventConfig[].eventParams.name]</td><td><code>String</code></td><td>The value of <code>key</code> in the event_params record.</td></tr><tr><td>[eventParams[].columnName]</td><td><code>String</code></td><td>Optional. The name of the column in the result table. If not provided the name will be the same as <code>eventParams.name</code>.</td></tr><tr><td>[eventConfig[].eventParams.type]</td><td><code>&#x27;string&#x27;</code> | <code>&#x27;int&#x27;</code> | <code>&#x27;double&#x27;</code> | <code>&#x27;float&#x27;</code> | <code>&#x27;coalesce&#x27;</code> | <code>&#x27;coalesce_float&#x27;</code></td><td>Optional. The name of the value in the event_params column. By default <code>string</code>.</td></tr><tr><td>[eventConfig[].userProperties]</td><td><code>Object</code></td><td>List of user properties unnested from GA4 raw table user_properties column. By default <code>userProperties</code> are not added. You could add your custom user_properties using <code>addUserProperties</code> method.</td></tr><tr><td>[eventConfig[].userProperties.name]</td><td><code>String</code></td><td>The value of <code>key</code> in the user_properties record.</td></tr><tr><td>[eventConfig[].userProperties.columnName]</td><td><code>String</code></td><td>Optional. The name of the column in the result table. If not provided the name will be the same as <code>userProperties.name</code>.</td></tr><tr><td>[eventConfig[].userProperties.type]</td><td><code>&#x27;string&#x27;</code> | <code>&#x27;int&#x27;</code> | <code>&#x27;double&#x27;</code> | <code>&#x27;float&#x27;</code> | <code>&#x27;coalesce&#x27;</code> | <code>&#x27;coalesce_float&#x27;</code></td><td>Optional. The name of the value in the event_params column. By default <code>string</code>.</td></tr><tr><td>[eventConfig[].queryParameters]</td><td><code>Object</code></td><td>List of query parameters from the unnested <code>event_params</code> column with the key <code>page_location</code>. You could add your custom query_parameters using <code>addQueryParameters</code> method.</td></tr><tr><td>[eventConfig[].queryParameters.name]</td><td><code>String</code></td><td>The query parameter name.</td></tr><tr><td>[eventConfig[].queryParameters.columnName]</td><td><code>String</code></td><td>Optional. The name of the column in the result table. If not provided the name will be the same as <code>queryParameters[].name</code>.</td></tr></tbody></table><p><strong>Example</strong>  </p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Create events</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> events </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ef</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">createEvents</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">configs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Publish events</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">events</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">forEach</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">event</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> event</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">publish</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><a name="module_dataform-ga4-sessions..EventFactory+createEcommerceEvents"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="eventfactorycreateecommerceevents--arrayevent"></a>eventFactory.createEcommerceEvents() ⇒ <code>Array.&lt;Event&gt;</code><a class="hash-link" href="#eventfactorycreateecommerceevents--arrayevent" title="Direct link to heading">#</a></h4><p>The method to create all recommended ecommerce events.</p><p><strong>Kind</strong>: instance method of <a href="#module_dataform-ga4-sessions..EventFactory"><code>EventFactory</code></a><br>
<strong>Returns</strong>: <code>Array.&lt;Event&gt;</code> - List of events<br>
<strong>Example</strong>  </p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Define your config</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> eventConfig </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token literal-property property" style="color:#36acaa">dataset</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;analytics_XXXXXX&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token literal-property property" style="color:#36acaa">incrementalTableName</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;events_XXXXXX&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Create all recommended events</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> events </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ef</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">createEcommerceEvents</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Publish events</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"> events</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">forEach</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">event</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> event</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">publish</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><a name="module_dataform-ga4-sessions..EventFactory+createFormEvents"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="eventfactorycreateformevents--arrayevent"></a>eventFactory.createFormEvents() ⇒ <code>Array.&lt;Event&gt;</code><a class="hash-link" href="#eventfactorycreateformevents--arrayevent" title="Direct link to heading">#</a></h4><p>The method to create all recommended events for form tracking.</p><p><strong>Kind</strong>: instance method of <a href="#module_dataform-ga4-sessions..EventFactory"><code>EventFactory</code></a><br>
<strong>Returns</strong>: <code>Array.&lt;Event&gt;</code> - List of events<br>
<strong>Example</strong>  </p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Define your config</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> eventConfig </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token literal-property property" style="color:#36acaa">dataset</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;analytics_XXXXXX&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token literal-property property" style="color:#36acaa">incrementalTableName</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;events_XXXXXX&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Create all recommended events</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> events </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ef</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">createFormEvents</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Publish events</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"> events</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">forEach</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">event</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> event</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">publish</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><a name="module_dataform-ga4-sessions..EventFactory+createAllRecommendedEvents"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="eventfactorycreateallrecommendedevents--arrayevent"></a>eventFactory.createAllRecommendedEvents() ⇒ <code>Array.&lt;Event&gt;</code><a class="hash-link" href="#eventfactorycreateallrecommendedevents--arrayevent" title="Direct link to heading">#</a></h4><p>The method to create all recommended and auto events.</p><p><strong>Kind</strong>: instance method of <a href="#module_dataform-ga4-sessions..EventFactory"><code>EventFactory</code></a><br>
<strong>Returns</strong>: <code>Array.&lt;Event&gt;</code> - List of events<br>
<strong>Example</strong>  </p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Define your config</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> eventConfig </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token literal-property property" style="color:#36acaa">dataset</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;analytics_XXXXXX&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token literal-property property" style="color:#36acaa">incrementalTableName</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;events_XXXXXX&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Create all recommended events</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> events </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ef</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">createAllRecommendedEvents</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Publish events</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"> events</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">forEach</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">event</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> event</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">publish</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><a name="module_dataform-ga4-sessions..Session"></a><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="dataform-ga4-sessionssession--dataformaction"></a>dataform-ga4-sessions~Session ⇐ <code>DataformAction</code><a class="hash-link" href="#dataform-ga4-sessionssession--dataformaction" title="Direct link to heading">#</a></h3><p>Creates Dataform Action to build GA4 Session tables based on BigQuery exported data. The class extends DataformAction class.</p><p><strong>Kind</strong>: inner class of <a href="#module_dataform-ga4-sessions"><code>dataform-ga4-sessions</code></a><br>
<strong>Extends</strong>: <code>DataformAction</code>  </p><ul><li><a href="#module_dataform-ga4-sessions..Session">~Session</a> ⇐ <code>DataformAction</code><ul><li><a href="#new_module_dataform-ga4-sessions..Session_new">new Session(sourceConfig, targetConfig)</a></li><li><a href="#module_dataform-ga4-sessions..Session+_uniqueKey">._uniqueKey</a></li><li><a href="#module_dataform-ga4-sessions..Session+_sourceMediumRules">._sourceMediumRules</a></li><li><a href="#module_dataform-ga4-sessions..Session+_postProcessing">._postProcessing</a></li><li><a href="#module_dataform-ga4-sessions..Session+_processingSteps">._processingSteps</a></li><li><a href="#module_dataform-ga4-sessions..Session+_lastNonDirectLookBackWindow">._lastNonDirectLookBackWindow</a></li><li><a href="#module_dataform-ga4-sessions..Session+_assertions">._assertions</a></li><li><a href="#module_dataform-ga4-sessions..Session+applyPreset">.applyPreset(presetName)</a></li><li><a href="#module_dataform-ga4-sessions..Session+getSqlUniqueId">.getSqlUniqueId()</a></li><li><a href="#module_dataform-ga4-sessions..Session+skipLastNonDirectStep">.skipLastNonDirectStep()</a></li><li><a href="#module_dataform-ga4-sessions..Session+skipChannelStep">.skipChannelStep()</a></li><li><a href="#module_dataform-ga4-sessions..Session+skipSourceMediumStep">.skipSourceMediumStep()</a></li><li><a href="#module_dataform-ga4-sessions..Session+publish">.publish()</a></li><li><a href="#module_dataform-ga4-sessions..Session+publishAssertions">.publishAssertions()</a></li></ul></li></ul><a name="new_module_dataform-ga4-sessions..Session_new"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="new-sessionsourceconfig-targetconfig"></a>new Session(sourceConfig, targetConfig)<a class="hash-link" href="#new-sessionsourceconfig-targetconfig" title="Direct link to heading">#</a></h4><p>Constructor for the Session class inherited from DataformAction class. And set default values for additional properties needed for the Session Action and also apply <code>standard</code> presets. Before creating the object of this class you need to declare GA4 source tables using <code>declareSources</code> method.</p><table><thead><tr><th>Param</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>sourceConfig</td><td><code>Object</code></td><td>GA4 BigQuery Source configuration</td></tr><tr><td>sourceConfig.database</td><td><code>string</code></td><td>The GA4 export database name. For example <code>&lt;YOUR-GCP-PROJECT-ID&gt;</code></td></tr><tr><td>sourceConfig.dataset</td><td><code>string</code></td><td>The GA4 export database name. For example <code>&lt;YOUR-GCP-PROJECT-ID&gt;</code></td></tr><tr><td>sourceConfig.incrementalTableName</td><td><code>string</code></td><td>Source incremental table name. For example <code>events_20240101</code></td></tr><tr><td>sourceConfig.nonIncrementalTableName</td><td><code>string</code></td><td>Source non-incremental table name. For example <code>events_*</code></td></tr><tr><td>sourceConfig.incrementalTableEventStepWhere</td><td><code>string</code></td><td>This property set where condition for the incremental queries. The important note this condition is added to the first step, not the final step. So if you filter for example events with source / medium values you could miss this data in the final result. Default is false</td></tr><tr><td>sourceConfig.nonIncrementalTableEventStepWhere</td><td><code>string</code></td><td>This property set where condition for the non-incremental queries. The important note this condition is added to the first step, not the final step. So if you filter for example events with source / medium values you could miss this data in the final result. Default is false</td></tr><tr><td>targetConfig</td><td><code>Object</code></td><td>Optional. Target configuration</td></tr><tr><td>targetConfig.schema</td><td><code>string</code></td><td>Optional. Target schema name. Default is <code>dataform_staging</code></td></tr><tr><td>targetConfig.tableName</td><td><code>string</code></td><td>Optional. Target table name. Default is <code>sessions</code></td></tr></tbody></table><p><strong>Example</strong>  </p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Define your config</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> sessionConfig </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token literal-property property" style="color:#36acaa">dataset</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;analytics_XXXXXX&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token literal-property property" style="color:#36acaa">incrementalTableName</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;events_XXXXXX&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Declare GA4 source tables</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">ga4</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">declareSources</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sessionConfig</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Create sessions object</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> sessions </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">ga4</span><span class="token class-name punctuation" style="color:#393A34">.</span><span class="token class-name">Session</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sessionConfig</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><a name="module_dataform-ga4-sessions..Session+_uniqueKey"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="session_uniquekey"></a>session._uniqueKey<a class="hash-link" href="#session_uniquekey" title="Direct link to heading">#</a></h4><p><strong>Kind</strong>: instance property of <a href="#module_dataform-ga4-sessions..Session"><code>Session</code></a><br>
<strong>Properties</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>uniqueKey</td><td><code>string</code></td><td>The <a href="https://cloud.google.com/dataform/docs/incremental-tables#merge_rows_in_an_incremental_table" target="_blank" rel="noopener noreferrer">unique key</a> for incremental tables. Dataform use this keys to generate merge queries. Default value for Session is <code>[&quot;date&quot;, &quot;session_id&quot;]</code></td></tr></tbody></table><p><strong>Example</strong>  </p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">session</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">uniqueKey</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;session_id&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;date&quot;</span><span class="token punctuation" style="color:#393A34">]</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><a name="module_dataform-ga4-sessions..Session+_sourceMediumRules"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="session_sourcemediumrules"></a>session._sourceMediumRules<a class="hash-link" href="#session_sourcemediumrules" title="Direct link to heading">#</a></h4><p>The order of sourceMediumRules is important, the first rule that meets the condition will be applied.</p><p><strong>Kind</strong>: instance property of <a href="#module_dataform-ga4-sessions..Session"><code>Session</code></a><br>
<strong>Properties</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>sourceMediumRules</td><td><code>Array.&lt;Object&gt;</code></td><td>The source medium rules. Default is defaultSourceMediumRules from <code>includes/constants.js</code>. This property is used to create a source medium columns in the final table.</td></tr><tr><td>sourceMediumRules[].columns</td><td><code>Array.&lt;String&gt;</code></td><td>The rule will check columns from the list in the final table.</td></tr><tr><td>sourceMediumRules[].conditionType</td><td><code>&#x27;NOT_NULL&#x27;</code></td><td>The rule condition type define the logic how to check columns. At the moment only <code>NOT_NULL</code> is supported.</td></tr><tr><td>sourceMediumRules[].conditionValue</td><td><code>String</code></td><td>The rule expected value. Not used by <code>NOT_NULL</code> condition type.</td></tr><tr><td>sourceMediumRules[].value</td><td><code>Object</code></td><td>The value of source medium that should be set in the final table if condition is met.</td></tr><tr><td>sourceMediumRules[].value.source</td><td><code>String</code></td><td>The source value that should be set. If the value should be literal it should be in the single quotes. For example <code>&quot;&#x27;google&#x27;&quot;&quot;</code> otherwise it should be a column name from the final table for example <code>&quot;source&quot;</code>.</td></tr><tr><td>sourceMediumRules[].value.medium</td><td><code>String</code></td><td>The medium value that should be set.</td></tr><tr><td>sourceMediumRules[].value.campaign</td><td><code>String</code></td><td>The campaign value that should be set.</td></tr></tbody></table><p><strong>Example</strong>  </p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">sessions</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">sourceMediumRules</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">columns</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;gclid_url&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">conditionType</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;NOT_NULL&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">conditionValue</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">value</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">source</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&#x27;google&#x27;&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">medium</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&#x27;cpc&#x27;&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">campaign</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;campaign&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token spread operator" style="color:#393A34">...</span><span class="token plain">sessions</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">sourceMediumRules</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><a name="module_dataform-ga4-sessions..Session+_postProcessing"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="session_postprocessing"></a>session._postProcessing<a class="hash-link" href="#session_postprocessing" title="Direct link to heading">#</a></h4><p><strong>Kind</strong>: instance property of <a href="#module_dataform-ga4-sessions..Session"><code>Session</code></a><br>
<strong>Properties</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>processingSteps</td><td><code>Object</code></td><td>The post processing config. At the moment only delete is supported.</td></tr><tr><td>processingSteps.delete</td><td><code>Array.&lt;String&gt;</code></td><td>Columns listed in this property will be deleted from the final table.  By default <code>[source, medium, campaign]</code> columns will be delete. Because during <code>sessions_with_source_medium_and_lp</code> step and <code>sessions_with_last_non_direct</code> these columns also will be added to <code>last_click_attribution</code> and <code>last_non_direct_attribution</code> accordingly.</td></tr></tbody></table><p><strong>Example</strong>  </p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">sessions</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">processingSteps</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">delete</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;column2&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;column2&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><a name="module_dataform-ga4-sessions..Session+_processingSteps"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="session_processingsteps"></a>session._processingSteps<a class="hash-link" href="#session_processingsteps" title="Direct link to heading">#</a></h4><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="default-session-processing-steps"></a>Default session processing steps<a class="hash-link" href="#default-session-processing-steps" title="Direct link to heading">#</a></h3><table><thead><tr><th>Step Name</th><th>Description</th></tr></thead><tbody><tr><td>events</td><td>Extract the needed columns from all events. Generate session_id</td></tr><tr><td>sessions_base</td><td>Group events into sessions by session id. Add standard columns like: session_start, session_end, session_engaged, landing_page etc.</td></tr><tr><td>sessions_with_source_medium_and_lp</td><td>Apply source / medium rules to create last click attribution</td></tr><tr><td>sessions_with_channel</td><td>Add channel grouping based on source / medium</td></tr><tr><td>sessions_with_last_non_direct</td><td>Add last non direct attribution based on lookback window</td></tr></tbody></table><p><strong>Kind</strong>: instance property of <a href="#module_dataform-ga4-sessions..Session"><code>Session</code></a><br>
<strong>Properties</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>processingSteps</td><td><code>Array.&lt;Object&gt;</code></td><td>The Session Action create a final table in a few steps. Queries for all default steps are defined in <code>includes/processing_steps.js</code>. You could skip any of step using methods below or add custom processing steps.</td></tr><tr><td>processingSteps[].queryName</td><td><code>String</code></td><td>The name of the step. The name should be unique.</td></tr><tr><td>processingSteps[].query</td><td><code>String</code></td><td>The Function that generates SQL for the step. The function has two parameters <code>this</code> and <code>ctx</code> which is <a href="https://cloud.google.com/dataform/docs/reference/dataform-core-reference#itablecontext" target="_blank" rel="noopener noreferrer">Dataform context</a>.</td></tr></tbody></table><a name="module_dataform-ga4-sessions..Session+_lastNonDirectLookBackWindow"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="session_lastnondirectlookbackwindow"></a>session._lastNonDirectLookBackWindow<a class="hash-link" href="#session_lastnondirectlookbackwindow" title="Direct link to heading">#</a></h4><p><strong>Kind</strong>: instance property of <a href="#module_dataform-ga4-sessions..Session"><code>Session</code></a><br>
<strong>Properties</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>lastNonDirectLookBackWindow</td><td><code>string</code></td><td>The last non direct look back window, if session has direct source / medium, a sessions_with_last_non_direct processing step tries to find previous non direct sessions inside the look back window. Default is 30 days. This property is used to create a last_non_direct_attribution columns in the final table.</td></tr></tbody></table><p><strong>Example</strong>  </p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">sessions</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">lastNonDirectLookBackWindow</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">60</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><a name="module_dataform-ga4-sessions..Session+_assertions"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="session_assertions"></a>session._assertions<a class="hash-link" href="#session_assertions" title="Direct link to heading">#</a></h4><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="default-session-assertions"></a>Default session assertions<a class="hash-link" href="#default-session-assertions" title="Direct link to heading">#</a></h3><table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td>Sessions Timeliness</td><td>Check that we have fresh sessions with a delay of no more than 2 days</td></tr><tr><td>Sessions Completeness</td><td>Check that we have sessions for all days without gaps</td></tr><tr><td>Sessions Validity</td><td>Check that sessions have all the required columns</td></tr></tbody></table><p><strong>Kind</strong>: instance property of <a href="#module_dataform-ga4-sessions..Session"><code>Session</code></a><br>
<strong>Properties</strong></p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>assertions</td><td><code>Array.&lt;{name: String, config: {description: String}, query: function(String): String}&gt;</code></td><td>List of default <a href="https://cloud.google.com/dataform/docs/assertions" target="_blank" rel="noopener noreferrer">Dataform assertions</a> for the class, but in most cases if you need extra assertions you could define them outside the class in separate files.</td></tr></tbody></table><a name="module_dataform-ga4-sessions..Session+applyPreset"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="sessionapplypresetpresetname"></a>session.applyPreset(presetName)<a class="hash-link" href="#sessionapplypresetpresetname" title="Direct link to heading">#</a></h4><p>The function add list of columns, event_params and user_properties to the final table based on the preset.</p><p><strong>Kind</strong>: instance method of <a href="#module_dataform-ga4-sessions..Session"><code>Session</code></a>  </p><table><thead><tr><th>Param</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>presetName</td><td><code>&quot;standard&quot;</code> | <code>&quot;extended&quot;</code> | <code>&quot;none&quot;</code></td><td>The name of the preset. The following presets are available: <code>standard</code>, <code>extended</code>, <code>none</code>. Default is <code>standard</code>.</td></tr></tbody></table><a name="module_dataform-ga4-sessions..Session+getSqlUniqueId"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="sessiongetsqluniqueid"></a>session.getSqlUniqueId()<a class="hash-link" href="#sessiongetsqluniqueid" title="Direct link to heading">#</a></h4><p>Helper method to generate SQL code to get unique id for each row in a final table, used inside publish method. By default it use getSqlSessionId from dataform-ga4-helpers package</p><p><strong>Kind</strong>: instance method of <a href="#module_dataform-ga4-sessions..Session"><code>Session</code></a>  </p><a name="module_dataform-ga4-sessions..Session+skipLastNonDirectStep"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="sessionskiplastnondirectstep"></a>session.skipLastNonDirectStep()<a class="hash-link" href="#sessionskiplastnondirectstep" title="Direct link to heading">#</a></h4><p>The method skips <code>sessions_with_last_non_direct</code> processing step.</p><p><strong>Kind</strong>: instance method of <a href="#module_dataform-ga4-sessions..Session"><code>Session</code></a><br>
<strong>Example</strong>  </p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">sessions</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">skipLastNonDirectStep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><a name="module_dataform-ga4-sessions..Session+skipChannelStep"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="sessionskipchannelstep"></a>session.skipChannelStep()<a class="hash-link" href="#sessionskipchannelstep" title="Direct link to heading">#</a></h4><p>The method skips <code>sessions_with_channel</code> processing step. It should be called only after <code>skipLastNonDirectStep</code> as it depends on it. Also if this method is called a table with channels definitions created by <code>helpers.getSqlSourceCategoriesTable</code> wouldn&#x27;t be added.</p><p><strong>Kind</strong>: instance method of <a href="#module_dataform-ga4-sessions..Session"><code>Session</code></a><br>
<strong>Example</strong>  </p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">sessions</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">skipLastNonDirectStep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">sessions</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">skipChannelStep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><a name="module_dataform-ga4-sessions..Session+skipSourceMediumStep"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="sessionskipsourcemediumstep"></a>session.skipSourceMediumStep()<a class="hash-link" href="#sessionskipsourcemediumstep" title="Direct link to heading">#</a></h4><p>The method skip <code>sessions_with_source_medium_and_lp</code> processing step. This method should be used if you want to create your own source / medium attribution logic. The order is important as each step uses the preceding step. So you can&#x27;t skip the channel step and have a last_non_direct step. But you could delete all the steps, and add your own processing steps.</p><p><strong>Kind</strong>: instance method of <a href="#module_dataform-ga4-sessions..Session"><code>Session</code></a><br>
<strong>Example</strong>  </p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Ignore all processing steps except the first</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">sessions</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">skipLastNonDirectStep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">sessions</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">skipChannelStep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">sessions</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">skipSourceMediumStep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><a name="module_dataform-ga4-sessions..Session+publish"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="sessionpublish"></a>session.publish()<a class="hash-link" href="#sessionpublish" title="Direct link to heading">#</a></h4><p>Main method to publish Dataform Action. This method generates SQL and then uses Dataform core <a href="https://cloud.google.com/dataform/docs/reference/dataform-core-reference#publish" target="_blank" rel="noopener noreferrer">publish</a> method to generate incremental and non-incremental session table.</p><p><strong>Kind</strong>: instance method of <a href="#module_dataform-ga4-sessions..Session"><code>Session</code></a><br>
<strong>Example</strong>  </p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">session</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">publish</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><a name="module_dataform-ga4-sessions..Session+publishAssertions"></a><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="sessionpublishassertions"></a>session.publishAssertions()<a class="hash-link" href="#sessionpublishassertions" title="Direct link to heading">#</a></h4><p>The method to publish default <a href="https://cloud.google.com/dataform/docs/assertions" target="_blank" rel="noopener noreferrer">Dataform assertions</a>.</p><p><strong>Kind</strong>: instance method of <a href="#module_dataform-ga4-sessions..Session"><code>Session</code></a><br>
<strong>Example</strong>  </p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI js"><pre tabindex="0" class="prism-code language-js codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">session</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">publishAssertions</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/edit/main/website/docs/api.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/dataform-ga4-sessions/events/event-id"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Event id</div></a></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#dataform-ga4-sessions" class="table-of-contents__link">dataform-ga4-sessions</a><ul><li><a href="#dataform-ga4-sessionsdataformaction" class="table-of-contents__link">dataform-ga4-sessions~DataformAction</a></li><li><a href="#dataform-ga4-sessionsevent--dataformaction" class="table-of-contents__link">dataform-ga4-sessions~Event ⇐ <code>DataformAction</code></a></li><li><a href="#dataform-ga4-sessionseventfactory" class="table-of-contents__link">dataform-ga4-sessions~EventFactory</a></li><li><a href="#dataform-ga4-sessionssession--dataformaction" class="table-of-contents__link">dataform-ga4-sessions~Session ⇐ <code>DataformAction</code></a></li><li><a href="#default-session-processing-steps" class="table-of-contents__link">Default session processing steps</a></li><li><a href="#default-session-assertions" class="table-of-contents__link">Default session assertions</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Artem Korneev. Built with Docusaurus.</div></div></div></footer></div>
<script src="/dataform-ga4-sessions/assets/js/runtime~main.a6d437cf.js"></script>
<script src="/dataform-ga4-sessions/assets/js/main.db21b18a.js"></script>
</body>
</html>